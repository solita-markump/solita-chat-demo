{
  "version": 1,
  "hooks": {
    "userPromptSubmitted": [
      {
        "type": "command",
        "bash": "raw=\"$(cat)\"; prompt=\"$(printf '%s' \"$raw\" | sed -n 's/.*\"prompt\"[[:space:]]*:[[:space:]]*\"\\([^\"]*\\)\".*/\\1/p')\"; [ -n \"$prompt\" ] || prompt=\"$raw\"; prompt=\"$(printf '%s' \"$prompt\" | sed 's/\\r$//' | sed 's/[[:space:]]\\+/ /g' | sed 's/^ *//;s/ *$//')\"; [ -n \"$prompt\" ] || exit 0; config_file=\".github/hooks/prompt-log-path.txt\"; log_path=\"$(head -n 1 \"$config_file\" 2>/dev/null | tr -d '\\r')\"; [ -n \"$log_path\" ] || exit 0; mkdir -p \"$(dirname \"$log_path\")\"; entry=\"$(date '+%Y-%m-%d %H:%M:%S')\"$'\\n'\"$prompt\"; if [ -f \"$log_path\" ]; then tmp_file=\"$log_path.tmp.$$\"; { printf '%s\\n\\n' \"$entry\"; cat \"$log_path\"; } > \"$tmp_file\" && mv \"$tmp_file\" \"$log_path\"; else printf '%s\\n' \"$entry\" > \"$log_path\"; fi",
        "powershell": "$raw = [Console]::In.ReadToEnd(); $obj = $null; try { $obj = $raw | ConvertFrom-Json } catch { }; $prompt = if ($obj -and $obj.prompt) { [string]$obj.prompt } elseif ($obj -and $obj.userPrompt) { [string]$obj.userPrompt } elseif ($obj -and $obj.message) { [string]$obj.message } elseif ($obj -and $obj.input) { [string]$obj.input } else { $raw }; $prompt = ($prompt -replace \"`r\", \"\").Trim(); if (-not $prompt) { exit 0 }; $configPath = \".github\\hooks\\prompt-log-path.txt\"; if (-not (Test-Path $configPath)) { exit 0 }; $logPath = (Get-Content -Path $configPath -TotalCount 1).Trim(); if (-not $logPath) { exit 0 }; $logDir = Split-Path -Path $logPath -Parent; if ($logDir) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }; $entry = \"$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')`n$prompt\"; $existing = if (Test-Path $logPath) { Get-Content -Path $logPath } else { @() }; Set-Content -Path $logPath -Value (@($entry, \"\") + $existing)",
        "cwd": ".",
        "timeoutSec": 5
      }
    ]
  }
}
